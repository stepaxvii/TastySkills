{% extends "base.html" %}

{% block title %}{{ restaurant.name }}{% if is_demo %} - –î–µ–º–æ{% endif %}{% endblock %}

{% block breadcrumb_items %}
    {% if is_demo %}
    <li class="breadcrumb-item active" aria-current="page"><span>{{ restaurant.name }} (–î–µ–º–æ)</span></li>
    {% else %}
    {% if user and user.role == 'admin' %}
    <li class="breadcrumb-item"><a href="/restaurants">–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</a></li>
    {% endif %}
    <li class="breadcrumb-item active" aria-current="page"><span>{{ restaurant.name }}</span></li>
    {% endif %}
{% endblock %}

{% block content %}
    {% if is_demo %}
    <div class="alert alert-info">
        <strong>–î–µ–º–æ-–≤–µ—Ä—Å–∏—è TastySkills</strong> - —ç—Ç–æ –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–Ω—é –¥–ª—è –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–æ–≤.
        <br><small>–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ <a href="/login">–≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</a>.</small>
    </div>
    {% endif %}

    <div class="page-header-unified">
        <h1>{{ restaurant.name }}</h1>
        {% if user and user.role in ['admin', 'manager'] %}
        <div class="management-buttons">
            <a href="/manage/sections/create/{{ restaurant.id }}" class="btn btn-success btn-lg">
                ‚ûï –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª
            </a>
        </div>
        {% endif %}
    </div>

    {% if sections %}
    <div class="categories-list">
        {% for section in sections %}
        <div class="section-card">
            <div class="section-content" onclick="window.location.href='/sections/{{ section.id }}'">
                <h5 class="card-title">
                    {{ section.name }}
                </h5>
                {% if section.description %}
                <p class="card-text">{{ section.description }}</p>
                {% endif %}
            </div>
            {% if user and user.role in ['admin', 'manager'] %}
            <div class="section-actions">
                <a href="/manage/sections/edit/{{ section.id }}" class="btn btn-outline-warning btn-sm">‚úèÔ∏è</a>
                <button type="button" class="btn btn-outline-danger btn-sm" 
                        data-delete-url="/manage/sections/delete/{{ section.id }}"
                        data-delete-message="–£–¥–∞–ª–∏—Ç—å —Ä–∞–∑–¥–µ–ª ¬´{{ section.name }}¬ª? –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –±–ª—é–¥–∞ –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.">
                    üóëÔ∏è
                </button>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <div class="text-center py-5">
            <h3 class="text-muted mb-3">–ó–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ</h3>
            <p class="text-muted mb-4">–í —ç—Ç–æ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ –ø–æ–∫–∞ –Ω–µ—Ç —Ä–∞–∑–¥–µ–ª–æ–≤ –º–µ–Ω—é.</p>
            {% if user and user.role in ['admin', 'manager'] %}
            <a href="/manage/sections/create/{{ restaurant.id }}" class="btn btn-success btn-lg">
                ‚ûï –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π —Ä–∞–∑–¥–µ–ª
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <div class="back-button-container">
        {% if user and user.role == 'admin' %}
            <a href="/restaurants" class="btn-back">‚Üê –ù–∞–∑–∞–¥ –∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º</a>
        {% else %}
            <a href="/" class="btn-back">‚Üê –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
        {% endif %}
    </div>

<script>
// –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤—Å–ø–ª—ã—Ç–∏—è —Å–æ–±—ã—Ç–∏–π –æ—Ç –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', function() {
    const actionButtons = document.querySelectorAll('.section-actions .btn, .section-actions form');
    actionButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    });
});
</script>
{% endblock %}

{% block scripts %}
<script>
// –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
const cards = document.querySelectorAll('.card');
cards.forEach((card, i) => {
    card.style.opacity = 0;
    setTimeout(() => {
        card.style.transition = 'opacity 0.5s';
        card.style.opacity = 1;
    }, 100 + i * 150);
});
</script>
{% endblock %}

{% include 'components/delete_modal.html' %} 