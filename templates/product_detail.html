{% extends "base.html" %}

{% block title %}{{ product.title }}{% if is_demo %} - –î–µ–º–æ{% endif %}{% endblock %}

{% set breadcrumbs %}
    {% if is_demo %}
    <li class="breadcrumb-item"><a href="/demo">–î–µ–º–æ-—Ä–µ—Å—Ç–æ—Ä–∞–Ω</a></li>
    <li class="breadcrumb-item"><a href="/demo">–†–∞–∑–¥–µ–ª—ã</a></li>
    <li class="breadcrumb-item"><a href="/demo">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
    <li class="breadcrumb-item active" aria-current="page"><span>{{ product.title }} (–î–µ–º–æ)</span></li>
    {% else %}
    {% if user and user.role == 'admin' %}
    <li class="breadcrumb-item"><a href="/restaurants">–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</a></li>
    {% endif %}
    <li class="breadcrumb-item"><a href="/restaurants/{{ product.restaurant_id }}">{{ product.restaurant.name }}</a></li>
    <li class="breadcrumb-item"><a href="/restaurants/{{ product.restaurant_id }}/sections/{{ product.category.section_id }}">{{ product.category.section.name }}</a></li>
    <li class="breadcrumb-item"><a href="/restaurants/{{ product.restaurant_id }}/sections/{{ product.category.section_id }}/categories/{{ product.category.id }}">{{ product.category.title }}</a></li>
    <li class="breadcrumb-item active" aria-current="page"><span>{{ product.title }}</span></li>
    {% endif %}
{% endset %}

{% block content %}
{% if is_demo %}
<div class="alert alert-info">
    <strong>–î–µ–º–æ-–≤–µ—Ä—Å–∏—è TastySkills</strong> - —ç—Ç–æ –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–Ω—é –¥–ª—è –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–æ–≤.
    <br><small>–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ <a href="/login">–≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</a>.</small>
</div>
{% endif %}

<div class="product-header">
    <h1>{{ product.title }}</h1>
    {% if product.weight %}
    <div class="product-weight">{{ product.weight }}</div>
    {% endif %}
</div>

<div class="product-content-grid">
    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: —Ñ–æ—Ç–æ -->
    <div class="product-image-section">
        <div class="product-image-placeholder">
            {% if product.image_path %}
            <img src="/uploads/{{ product.image_path }}" alt="{{ product.title }}" style="width:100%;height:100%;object-fit:cover;border-radius:8px;">
            {% else %}
            <i class="fas fa-utensils"></i>
            {% endif %}
        </div>
        <div class="product-image-text">–§–æ—Ç–æ –±–ª—é–¥–∞</div>
    </div>

    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="product-info-section">
        {% if product.allergens %}
        <div class="product-info-card">
            <h4>‚ö†Ô∏è –ê–ª–ª–µ—Ä–≥–µ–Ω—ã</h4>
            <p>{{ product.allergens }}</p>
        </div>
        {% endif %}

        {% if product.gastronomic_pairings %}
        <div class="product-info-card">
            <h4>üç∑ –ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è</h4>
            <p>{{ product.gastronomic_pairings }}</p>
        </div>
        {% endif %}
    </div>
</div>

<!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥—É–∫—Ç–µ -->
<div class="product-info-card">
    <h4>ü•ò –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã</h4>
    <p>{{ product.ingredients }}</p>
</div>

{% if product.description %}
<div class="product-info-card">
    <h4>üë®‚Äçüç≥ –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è</h4>
    <p>{{ product.description }}</p>
</div>
{% endif %}

{% if product.features %}
<div class="product-info-card">
    <h4>‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∞</h4>
    <p>{{ product.features }}</p>
</div>
{% endif %}

{% if product.table_setting %}
<div class="product-info-card">
    <h4>üçΩÔ∏è –ü–æ–¥–∞—á–∞</h4>
    <p>{{ product.table_setting }}</p>
</div>
{% endif %}

{% if user and user.role in ['admin', 'manager'] %}
<div class="product-management">
    <a href="/restaurants/{{ product.restaurant_id }}/sections/{{ product.category.section_id }}/categories/{{ product.category.id }}/products/{{ product.id }}/manage/edit" class="btn btn-outline-warning" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª—é–¥–æ">
        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
    </a>
    <button type="button" class="btn btn-outline-danger" 
            data-delete-url="/restaurants/{{ product.restaurant_id }}/sections/{{ product.category.section_id }}/categories/{{ product.category.id }}/products/{{ product.id }}/manage/delete"
            data-delete-message="–£–¥–∞–ª–∏—Ç—å –±–ª—é–¥–æ ¬´{{ product.title }}¬ª?"
            title="–£–¥–∞–ª–∏—Ç—å –±–ª—é–¥–æ">
        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
    </button>
</div>
{% endif %}

<div class="back-button-container">
    <a href="/restaurants/{{ product.restaurant_id }}/sections/{{ product.category.section_id }}/categories/{{ product.category.id }}" class="btn-back">‚Üê –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
</div>
{% endblock %}

{% block scripts %}
<script>
// –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
const cards = document.querySelectorAll('.product-info-card');
cards.forEach((card, i) => {
    card.style.opacity = 0;
    setTimeout(() => {
        card.style.transition = 'opacity 0.5s';
        card.style.opacity = 1;
    }, 100 + i * 150);
});
</script>
{% endblock %}

{% include 'components/delete_modal.html' %} 