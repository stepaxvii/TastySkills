{% extends "base.html" %}

{% block title %}{{ section.name }}{% if is_demo %} - –î–µ–º–æ{% endif %}{% endblock %}

{% set breadcrumbs %}
    {% if is_demo %}
    <li class="breadcrumb-item"><a href="/demo">–î–µ–º–æ-—Ä–µ—Å—Ç–æ—Ä–∞–Ω</a></li>
    <li class="breadcrumb-item active" aria-current="page"><span>{{ section.name }} (–î–µ–º–æ)</span></li>
    {% else %}
    {% if user and user.role == 'admin' %}
    <li class="breadcrumb-item"><a href="/restaurants">–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</a></li>
    {% endif %}
    <li class="breadcrumb-item"><a href="/restaurants/{{ section.restaurant_id }}">{{ section.restaurant.name }}</a></li>
    <li class="breadcrumb-item active" aria-current="page"><span>{{ section.name }}</span></li>
    {% endif %}
{% endset %}

{% block content %}
    {% if is_demo %}
    <div class="alert alert-info">
        <strong>–î–µ–º–æ-–≤–µ—Ä—Å–∏—è TastySkills</strong> - —ç—Ç–æ –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–Ω—é –¥–ª—è –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–æ–≤.
        <br><small>–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ <a href="/login">–≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</a>.</small>
    </div>
    {% endif %}

    <div class="page-header-unified">
        <h1>{{ section.name }}</h1>
        {% if user and user.role in ['admin', 'manager'] %}
        <div class="management-buttons">
            <a href="/restaurants/{{ section.restaurant_id }}/sections/{{ section.id }}/manage/categories/create" class="btn btn-outline-success" title="–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é">
                ‚ûï –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            </a>
            <a href="/restaurants/{{ section.restaurant_id }}/sections/{{ section.id }}/manage/edit" class="btn btn-outline-warning" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª">
                ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª
            </a>
        </div>
        {% endif %}
    </div>

    {% if section.description %}
    <div class="alert alert-info">
        {{ section.description }}
    </div>
    {% endif %}

    {% if categories %}
    <div class="categories-list">
        {% for category in categories %}
        <div class="category-card">
            <div class="category-content" onclick="window.location.href='/restaurants/{{ section.restaurant_id }}/sections/{{ section.id }}/categories/{{ category.id }}'">
                <h5 class="category-title">{{ category.title }}</h5>
                {% if category.description %}
                <p class="category-description">{{ category.description }}</p>
                {% endif %}
            </div>
            {% if user and user.role in ['admin', 'manager'] %}
            <div class="category-actions">
                <a href="/restaurants/{{ section.restaurant_id }}/sections/{{ section.id }}/categories/{{ category.id }}/manage/edit" class="btn btn-outline-warning btn-sm" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é">‚úèÔ∏è</a>
                <button type="button" class="btn btn-outline-danger btn-sm" 
                        data-delete-url="/restaurants/{{ section.restaurant_id }}/sections/{{ section.id }}/categories/{{ category.id }}/manage/delete"
                        data-delete-message="–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é ¬´{{ category.title }}¬ª? –í—Å–µ –±–ª—é–¥–∞ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã."
                        title="–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é">
                    üóëÔ∏è
                </button>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <h3>–ó–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ</h3>
        <p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π.</p>
        {% if user and user.role in ['admin', 'manager'] %}
        <a href="/restaurants/{{ section.restaurant_id }}/sections/{{ section.id }}/manage/categories/create" class="btn btn-outline-success">
            ‚ûï –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        </a>
        {% endif %}
    </div>
    {% endif %}

    <div class="back-button-container">
        <a href="/restaurants/{{ section.restaurant_id }}" class="btn-back">‚Üê –∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É</a>
    </div>
{% endblock %}

{% block scripts %}
<script>
// –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
const cards = document.querySelectorAll('.category-card');
cards.forEach((card, i) => {
    card.style.opacity = 0;
    setTimeout(() => {
        card.style.transition = 'opacity 0.5s';
        card.style.opacity = 1;
    }, 100 + i * 150);
});

// –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤—Å–ø–ª—ã—Ç–∏—è —Å–æ–±—ã—Ç–∏–π –æ—Ç –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', function() {
    const actionButtons = document.querySelectorAll('.category-actions .btn, .category-actions form');
    actionButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    });
});
</script>
{% endblock %}

{% include 'components/delete_modal.html' %} 